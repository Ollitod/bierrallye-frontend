"use strict";(self.webpackChunkbierrallye_frontend=self.webpackChunkbierrallye_frontend||[]).push([[585],{5585:(C,u,o)=>{o.r(u),o.d(u,{LoginComponent:()=>S});var d=o(4755),r=o(9401),c=o(1728),l=o(9114),m=o(8097),s=(()=>((s=s||{}).ADMIN="ADMIN",s.USER="USER",s.EMPLOYEE="EMPLOYEE",s))(),f=o(3900),t=o(2223),p=o(3144);let v=(()=>{class n{constructor(e){this.http=e}authenticate(e){return this.http.post("https://bierrallye.meinhard.at/authenticate",e)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(p.eN))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var g=o(2018),y=o(9155),E=o(2238),L=o(1963);let S=(()=>{class n{constructor(e,i,h,U,A){this.authService=e,this.toastr=i,this.router=h,this.tokenService=U,this.userService=A,this.loginForm=new r.cw({username:new r.NI("",{validators:[r.kI.required]}),password:new r.NI("",{validators:[r.kI.required]})})}ngOnDestroy(){this.sub?.unsubscribe()}authenticate(){this.sub=this.authService.authenticate(this.loginForm.getRawValue()).pipe((0,f.w)(e=>(this.tokenService.storeToken(e.token),this.userService.loginUser(),this.userService.user))).subscribe(e=>{if(e?.role){const i=this.getRouteByRole(e?.role);console.log(i),this.router.navigate([i]),this.toastr.success("Login erfolgreich","Erfolgreich")}},e=>{this.toastr.error("Username/Passwort falsch","Fehler")})}getRouteByRole(e){switch(e){case s.ADMIN:return"/onboarding";case s.USER:return"/race";case s.EMPLOYEE:return"/penalty";default:return"/"}}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(v),t.Y36(g._W),t.Y36(y.F0),t.Y36(E.B),t.Y36(L.K))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-login"]],standalone:!0,features:[t.jDz],decls:12,vars:2,consts:[[3,"formGroup"],[1,"form-container"],["formControlName","username","id","username","matInput",""],["type","password","formControlName","password","id","password","matInput",""],["color","primary","mat-raised-button","","type","submit",3,"disabled","click"]],template:function(e,i){1&e&&(t.TgZ(0,"form",0)(1,"div",1)(2,"mat-form-field")(3,"mat-label"),t._uU(4,"Username"),t.qZA(),t._UZ(5,"input",2),t.qZA(),t.TgZ(6,"mat-form-field")(7,"mat-label"),t._uU(8,"Passwort"),t.qZA(),t._UZ(9,"input",3),t.qZA(),t.TgZ(10,"button",4),t.NdJ("click",function(){return i.authenticate()}),t._uU(11," Login "),t.qZA()()()),2&e&&(t.Q6J("formGroup",i.loginForm),t.xp6(10),t.Q6J("disabled",!i.loginForm.valid))},dependencies:[d.ez,r.u5,r._Y,r.Fj,r.JJ,r.JL,c.ot,c.lW,l.lN,l.KE,l.hX,m.c,m.Nt,r.UX,r.sg,r.u],styles:[".form-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;background-color:#fdf1cd;padding:15px}"]}),n})()}}]);